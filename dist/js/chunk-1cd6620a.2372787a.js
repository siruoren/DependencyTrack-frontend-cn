(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1cd6620a"],{"0864":function(e,t,i){"use strict";var n=i("900c");t["a"]={data:function(){return{configUrl:"".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_CONFIG_PROPERTY,"/"),labelIcon:{dataOn:"✓",dataOff:"✕"}}},methods:{updateConfigProperties:function(e){for(var t=this,i=[],a=0;a<e.length;a++){var o=e[a];o.propertyValue=n["a"].trimToNull(o.propertyValue),i.push(o)}var r="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_CONFIG_PROPERTY,"/aggregate");this.axios.post(r,i).then((function(e){t.$toastr.s(t.$t("admin.configuration_saved"))})).catch((function(e){t.$toastr.w(t.$t("condition.unsuccessful_action"))}))},updateConfigProperty:function(e,t,i){var a=this;i=n["a"].trimToNull(i);var o="".concat(this.$api.BASE_URL,"/").concat(this.$api.URL_CONFIG_PROPERTY,"/");this.axios.post(o,{groupName:e,propertyName:t,propertyValue:i}).then((function(e){a.$toastr.s(a.$t("admin.configuration_saved"))})).catch((function(e){a.$toastr.w(a.$t("condition.unsuccessful_action"))}))}}}},1156:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-form-group",{attrs:{id:e.id,label:e.label,"label-for":e.id+"-input","label-class":e.labelClasses}},[i("b-input-group",{class:e.inputGroupSize},[e.icon?i("b-input-group-prepend",[i("b-input-group-text",[i("i",{class:e.icon})])],1):e._e(),i("b-form-datepicker",e._g({class:e.inputClasses,attrs:{id:e.id+"-input",placeholder:e.label,state:e.feedbackState(),autocomplete:e.autocomplete,required:e.isRequired,readonly:e.readonly,disabled:e.isDisabled,"date-format-options":{year:"numeric",month:"2-digit",day:"2-digit"}},on:{blur:function(t){e.hadFocus=!0}},model:{value:e.innerValue,callback:function(t){e.innerValue=t},expression:"innerValue"}},e.inputListeners)),e.tooltip?i("b-input-group-append",[i("b-input-group-text",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:e.tooltip}},[i("i",{staticClass:"cui-info font-lg"})])],1):e._e()],1),"true"===this.feedback?i("b-form-invalid-feedback",{attrs:{state:e.feedbackState()}},[e._v("\n    "+e._s(e.feedbackText)+"\n  ")]):e._e()],1)},a=[],o=i("900c"),r={props:{id:String,label:String,value:String,inputGroupSize:String,icon:String,type:String,autocomplete:String,autofocus:String,tooltip:String,feedbackText:String,feedback:String,lazy:String,required:String,readonly:Boolean,disabled:Boolean,state:{default:void 0,type:Boolean}},data:function(){return{isFocused:!1,isRequired:!1,isDisabled:!1,hadFocus:!1}},beforeMount:function(){this.isFocused=o["a"].toBoolean(this.autofocus),this.isRequired=o["a"].toBoolean(this.required),this.isDisabled=o["a"].toBoolean(this.disabled),this.readonly=o["a"].toBoolean(this.readonly)},computed:{innerValue:{get:function(){return this.value&&this.value.length,this.value},set:function(e){return e}},inputListeners:function(){var e=this;return Object.assign({},this.$listeners,{input:function(t){e.$emit("input",t)}})},inputClasses:function(){return this.isRequired?"required":null},labelClasses:function(){return this.isRequired?"required":null}},methods:{feedbackState:function(){if(!this.isDisabled||this.isRequired)return void 0!==this.state?this.state:o["a"].toBoolean(this.lazy)&&o["a"].toBoolean(this.required)?!!(this.value&&this.value.length>0)||!this.hadFocus&&void 0:!!(this.value&&this.value.length>0)||void 0}}},s=r,d=i("2877"),l=Object(d["a"])(s,n,a,!1,null,null,null);t["a"]=l.exports},"4c13":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-card",{attrs:{"no-body":"",header:e.header}},[i("b-card-body",[i("c-switch",e._b({attrs:{disabled:!this.vulnsourceEnabled&&!this.nvdFeedsUrl,id:"vulnsourceEnabled",color:"primary",label:""},model:{value:e.vulnsourceEnabled,callback:function(t){e.vulnsourceEnabled=t},expression:"vulnsourceEnabled"}},"c-switch",e.labelIcon,!1)),e._v("\n    "+e._s(e.$t("admin.vulnsource_nvd_enable"))+"\n    "),i("hr"),e._v("\n    "+e._s(e.$t("admin.vulnsource_nvd_desc"))+"\n    "),i("br"),i("br"),e._v("\n    "+e._s(e.$t("admin.vulnsource_nvd_notice"))+"\n    "),i("hr"),i("b-validated-input-group-form-input",{attrs:{id:"nvd-feeds-url",label:e.$t("admin.vulnsource_nvd_feeds_url"),"input-group-size":"mb-3",rules:"required",type:"text",lazy:"true"},model:{value:e.nvdFeedsUrl,callback:function(t){e.nvdFeedsUrl=t},expression:"nvdFeedsUrl"}}),i("hr"),i("c-switch",e._b({attrs:{id:"nvdApiEnabled",color:"primary",label:""},model:{value:e.nvdApiEnabled,callback:function(t){e.nvdApiEnabled=t},expression:"nvdApiEnabled"}},"c-switch",e.labelIcon,!1)),e._v("\n    "+e._s(e.$t("admin.nvd_enable_mirroring_via_api"))+"\n    "),i("p",{staticClass:"font-sm text-muted"},[i("span",{staticClass:"fa fa-question-circle"},[e._v(" ")]),i("a",{attrs:{href:e.nvdApiWhyEnableUrl,target:"_blank"}},[e._v(e._s(e.$t("admin.nvd_why_enable_api_help")))])]),i("c-switch",e._b({attrs:{disabled:!this.nvdApiEnabled,id:"nvdApiDownloadFeeds",color:"primary",label:""},model:{value:e.nvdApiDownloadFeeds,callback:function(t){e.nvdApiDownloadFeeds=t},expression:"nvdApiDownloadFeeds"}},"c-switch",e.labelIcon,!1)),e._v("\n    "+e._s(e.$t("admin.nvd_additionally_download_feeds"))+"\n    "),i("p",{staticClass:"font-sm text-muted"},[i("span",{staticClass:"fa fa-question-circle"},[e._v(" ")]),e._v("\n      "+e._s(e.$t("admin.nvd_additionally_download_feeds_help"))+" "),i("code",[e._v("/mirror/nvd")])]),i("b-validated-input-group-form-input",{attrs:{id:"nvdApiEndpoint",label:"API endpoint","input-group-size":"mb-3",lazy:"true"},model:{value:e.nvdApiEndpoint,callback:function(t){e.nvdApiEndpoint=t},expression:"nvdApiEndpoint"}}),i("b-validated-input-group-form-input",{attrs:{id:"nvdApiKey",label:"API key","input-group-size":"mb-3",type:"password",lazy:"true"},model:{value:e.nvdApiKey,callback:function(t){e.nvdApiKey=t},expression:"nvdApiKey"}}),i("p",{staticClass:"font-sm text-muted"},[i("span",{staticClass:"fa fa-question-circle"},[e._v(" ")]),i("a",{attrs:{href:e.nvdApiRequestApiKeyUrl,target:"_blank"}},[e._v(e._s(e.$t("admin.nvd_request_api_key_help")))])]),i("b-form-group",{attrs:{label:e.$t("admin.nvd_api_last_modification")}},[i("b-input-group",[i("b-form-datepicker",{attrs:{id:"nvdApiLastModifiedDate","date-format-options":{year:"numeric",month:"numeric",day:"numeric"},min:e.nvdApiLastModifiedDateMin,max:e.nvdApiLastModifiedDateMax,locale:"en-GB","reset-button":!0,"show-decade-nav":!0},model:{value:e.nvdApiLastModifiedDate,callback:function(t){e.nvdApiLastModifiedDate=t},expression:"nvdApiLastModifiedDate"}}),i("b-form-timepicker",{attrs:{id:"nvdApiLastModifiedTime",locale:"en-GB","reset-button":!0},model:{value:e.nvdApiLastModifiedTime,callback:function(t){e.nvdApiLastModifiedTime=t},expression:"nvdApiLastModifiedTime"}})],1)],1),i("p",{staticClass:"font-sm text-muted"},[i("span",{staticClass:"fa fa-question-circle"},[e._v(" ")]),e._v("\n      "+e._s(e.$t("admin.nvd_api_last_modification_help"))+"\n    ")]),i("p",{staticClass:"font-sm text-muted"},[i("span",{staticClass:"fa fa-warning"},[e._v(" ")]),e._v("\n      "+e._s(e.$t("admin.nvd_api_last_modification_warning"))+"\n    ")])],1),i("b-card-footer",[i("b-button",{staticClass:"px-4",attrs:{disabled:this.vulnsourceEnabled&&!this.nvdFeedsUrl,variant:"outline-primary"},on:{click:e.saveChanges}},[e._v("\n        "+e._s(e.$t("message.update"))+"\n    ")])],1)],1)},a=[],o=i("f1fb"),r=i("cc9d"),s=i("1156"),d=i("900c"),l=i("0864"),u={mixins:[l["a"]],props:{header:String},components:{cSwitch:o["o"],BValidatedInputGroupFormInput:r["a"],BInputGroupFormDatepicker:s["a"]},data:function(){return{vulnsourceEnabled:!1,nvdFeedsUrl:"",nvdApiEnabled:!1,nvdApiDownloadFeeds:!1,nvdApiEndpoint:"",nvdApiKey:"",nvdApiLastModifiedDate:"",nvdApiLastModifiedDateMin:new Date(1999,1,1),nvdApiLastModifiedDateMax:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()),nvdApiLastModifiedTime:"",nvdApiWhyEnableUrl:"https://nvd.nist.gov/General/News/change-timeline",nvdApiRequestApiKeyUrl:"https://nvd.nist.gov/developers/request-an-api-key",labelIcon:{dataOn:"✓",dataOff:"✕"}}},methods:{saveChanges:function(){this.updateConfigProperties([{groupName:"vuln-source",propertyName:"nvd.enabled",propertyValue:this.vulnsourceEnabled},{groupName:"vuln-source",propertyName:"nvd.feeds.url",propertyValue:this.nvdFeedsUrl},{groupName:"vuln-source",propertyName:"nvd.api.enabled",propertyValue:this.nvdApiEnabled},{groupName:"vuln-source",propertyName:"nvd.api.download.feeds",propertyValue:this.nvdApiDownloadFeeds},{groupName:"vuln-source",propertyName:"nvd.api.url",propertyValue:this.nvdApiEndpoint},{groupName:"vuln-source",propertyName:"nvd.api.key",propertyValue:this.nvdApiKey},{groupName:"vuln-source",propertyName:"nvd.api.last.modified.epoch.seconds",propertyValue:this.getApiLastModifiedEpochSeconds()}])},getApiLastModifiedEpochSeconds:function(){if(!this.nvdApiLastModifiedDate)return 0;if(!this.nvdApiLastModifiedTime){var e=Date.parse("".concat(this.nvdApiLastModifiedDate,"T00:00:00Z"));return e?e/1e3:0}var t=Date.parse("".concat(this.nvdApiLastModifiedDate,"T").concat(this.nvdApiLastModifiedTime,"Z"));return t?t/1e3:0}},created:function(){var e=this;this.axios.get(this.configUrl).then((function(t){for(var i=t.data.filter((function(e){return"vuln-source"===e.groupName})),n=0;n<i.length;n++){var a=i[n];switch(a.propertyName){case"nvd.enabled":e.vulnsourceEnabled=d["a"].toBoolean(a.propertyValue);break;case"nvd.feeds.url":e.nvdFeedsUrl=a.propertyValue;break;case"nvd.api.enabled":e.nvdApiEnabled=d["a"].toBoolean(a.propertyValue);break;case"nvd.api.download.feeds":e.nvdApiDownloadFeeds=d["a"].toBoolean(a.propertyValue);break;case"nvd.api.url":e.nvdApiEndpoint=a.propertyValue;break;case"nvd.api.key":e.nvdApiKey=a.propertyValue;break;case"nvd.api.last.modified.epoch.seconds":var o=parseInt(a.propertyValue);if(!o)continue;var r=new Date(0);r.setUTCSeconds(o),e.nvdApiLastModifiedDate=r.toISOString().split("T")[0],e.nvdApiLastModifiedTime=r.toISOString().split("T")[1].split(".")[0];break}}}))}},p=u,c=i("2877"),v=Object(c["a"])(p,n,a,!1,null,null,null);t["default"]=v.exports},cc9d:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("validation-provider",{attrs:{vid:e.id,name:e.label,rules:e.rules,mode:e.mode},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors,a=t.valid;return[i("b-form-group",{attrs:{id:e.id,label:e.label,"label-for":e.id+"-input"}},[i("b-input-group",{class:e.inputGroupSize},[e.icon?i("b-input-group-prepend",[i("b-input-group-text",[i("i",{class:e.icon})])],1):e._e(),i("b-form-input",e._g({class:e.inputClasses,attrs:{id:e.id+"-input",type:e.type,placeholder:e.label,state:e.errorHandlingMethod(n,a),autocomplete:e.autocomplete,autofocus:e.isFocused},model:{value:e.innerValue,callback:function(t){e.innerValue=t},expression:"innerValue"}},e.inputListeners)),e.tooltip?i("b-input-group-append",[i("b-input-group-text",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:e.tooltip}},[i("i",{staticClass:"cui-info font-lg"})])],1):e._e()],1),i("b-form-invalid-feedback",{attrs:{state:e.errorHandlingMethod(n,a)}},[e._v("\n      "+e._s(n[0])+"\n    ")])],1)]}}])})},a=[],o=i("7bb1"),r=i("900c"),s={name:"BValidatedInputGroupFormInput",components:{ValidationProvider:o["b"]},props:{id:String,label:String,value:String,inputGroupSize:String,icon:String,rules:String,mode:String,type:String,autocomplete:String,autofocus:String,tooltip:String,lazy:String},data:function(){return{isFocused:!1}},beforeMount:function(){!0!==this.autofocus&&"true"!==this.autofocus||(this.isFocused=!0)},computed:{innerValue:{get:function(){return this.value},set:function(e){return e}},inputListeners:function(){var e=this;return Object.assign({},this.$listeners,{input:function(t){e.$emit("input",t)}})},inputClasses:function(){var e="form-control";return!r["a"].toBoolean(this.lazy)&&this.rules&&this.rules.includes("required")&&(e+=" required"),e}},methods:{errorHandlingMethod:function(e,t){return this.rules?r["a"].toBoolean(this.lazy)?!e[0]&&(!!t||null):!e[0]&&!!t:null}}},d=s,l=i("2877"),u=Object(l["a"])(d,n,a,!1,null,null,null);t["a"]=u.exports}}]);